<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.54">


<title data-react-helmet="true">Message Durability Modes | .NET Client for ActiveMQ Artemis</title>

<meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Message Durability Modes | .NET Client for ActiveMQ Artemis"><meta data-react-helmet="true" name="description" content="ActiveMQ Artemis supports two types of durability modes for messages: `durable` and `nondurable`. By default each message sent by the client using `SendAsync` method is durable. That means that the broker actually has to persist the message on the disk before the confirmation frame (ack) will be sent back to the client. The confirmation frame is what we can *await* for."><meta data-react-helmet="true" property="og:description" content="ActiveMQ Artemis supports two types of durability modes for messages: `durable` and `nondurable`. By default each message sent by the client using `SendAsync` method is durable. That means that the broker actually has to persist the message on the disk before the confirmation frame (ack) will be sent back to the client. The confirmation frame is what we can *await* for."><meta data-react-helmet="true" property="og:url" content="https://havret.github.io/dotnet-activemq-artemis-client/docs/message-durability">

<link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico">


<link rel="stylesheet" href="/styles.f52cb2fc.css">


<link rel="preload" href="/styles.2fbd7565.js" as="script">

<link rel="preload" href="/runtime~main.8997092e.js" as="script">

<link rel="preload" href="/main.fe00ff35.js" as="script">

<link rel="preload" href="/common.d25bd83d.js" as="script">

<link rel="preload" href="/2.0560f2c7.js" as="script">

<link rel="preload" href="/13.cc8afce6.js" as="script">

<link rel="preload" href="/20ac7829.89cafa85.js" as="script">

<link rel="preload" href="/17896441.6cce8aee.js" as="script">

<link rel="preload" href="/b4e34d1d.9150516b.js" as="script">

</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script>
<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.svg" alt="My Site Logo"><strong class="navbar__title">.NET Client for ActiveMQ Artemis</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/getting-started">Docs</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.svg" alt="My Site Logo"><strong class="navbar__title">.NET Client for ActiveMQ Artemis</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" position="left" href="/docs/getting-started">Docs</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp"><div class="sidebar_1kLs"><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started">Getting Started</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Features</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/message-payload">Message payload</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" tabindex="0" href="/docs/message-durability">Message Durability</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/message-priority">Message Priority</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/auto-recovery">Automatic Recovery</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="container padding-vert--lg docItemWrapper_1cc7"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">Message Durability Modes</h1></header><div class="markdown"><p>ActiveMQ Artemis supports two types of durability modes for messages: <code>durable</code> and <code>nondurable</code>. By default each message sent by the client using <code>SendAsync</code> method is durable. That means that the broker actually has to persist the message on the disk before the confirmation frame (ack) will be sent back to the client. The confirmation frame is what we can <em>await</em> for.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-csharp codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">await producer.SendAsync(new Message(&quot;foo&quot;)</span></div></div></div></div></div><p>When <code>SendAsync</code> completes without errors we may expect that the message will be delivered with <em>at least once</em> semantics. Durable messages incur more overhead due to the need to store the message, and value reliability over performance.</p><p>Setting message durability mode to <code>Nondurable</code> instructs the broker not to persist the message. By default each message sent by the client using <code>Send</code> method is nondurable. <code>Send</code> is non-blocking both in terms of packets transmission (it uses <a href="https://docs.microsoft.com/en-us/dotnet/api/system.net.sockets.socket.sendasync">Socket.SendAsync</a> method in the fire and forget manner) and in terms of waiting for confirmation from the broker (it doesn&#x27;t). As a result, <em>at most once</em> is all that you can expect in terms of message delivery guarantees from this combination. Nondurable messages incur less overhead and value performance over reliability.</p><p>Default message durability settings may be overridden via producer configuration:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-csharp codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">var producer = await connection.CreateProducerAsync(new ProducerConfiguration</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Address = &quot;a1&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    RoutingType = AddressRoutingType.Anycast,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    MessageDurabilityMode = DurabilityMode.Nondurable</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">});</span></div></div></div></div></div><p>And for each message individually:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-csharp codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">await producer.SendAsync(new Message(&quot;foo&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    DurabilityMode = DurabilityMode.Nondurable // takes precedence over durability</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                               // mode specified on the producer level</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">});</span></div></div></div></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/master/website/../docs/message-durability.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/message-payload"><div class="pagination-nav__link--sublabel">Previous</div><div class="pagination-nav__link--label">« Message payload</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/message-priority"><div class="pagination-nav__link--sublabel">Next</div><div class="pagination-nav__link--label">Message Priority »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started">Get Started</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://github.com/Havret/dotnet-activemq-artemis-client">GitHub</a></li></ul></div></div><div class="text--center"><div>Copyright © 2020 Havret. Built with Docusaurus.</div></div></div></footer>
</div>

<script src="/styles.2fbd7565.js"></script>

<script src="/runtime~main.8997092e.js"></script>

<script src="/main.fe00ff35.js"></script>

<script src="/common.d25bd83d.js"></script>

<script src="/2.0560f2c7.js"></script>

<script src="/13.cc8afce6.js"></script>

<script src="/20ac7829.89cafa85.js"></script>

<script src="/17896441.6cce8aee.js"></script>

<script src="/b4e34d1d.9150516b.js"></script>


</body>
</html>